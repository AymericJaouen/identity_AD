#Inactive user at the today's date - 180 days (6 months)
$logondate = (Get-Date).AddDays(-180).ToFileTime()

# Get all enabled users with LastLogonTimestamp attribute
$EnabledUsers = Get-ADUser -Filter {Enabled -eq $true} -Properties LastLogonTimestamp

# Count active users (logged in within last 6 months)
$ActiveUsers = $EnabledUsers | Where-Object { $_.LastLogonTimestamp -and $_.LastLogonTimestamp -ge $logondate }
$TotalActive = ($ActiveUsers  | Measure-Object).Count

# Count inactive users (no login in 6+ months)
$InactiveUsers = $EnabledUsers | Where-Object { $_.LastLogonTimestamp -and $_.LastLogonTimestamp -lt $logondate }
$TotalInactive = $InactiveUsers.Count

# Count users with no LastLogonTimestamp (never logged in).  New accounts and service accounts that don't use interactive login
$NeverLoggedInUsers = $EnabledUsers | Where-Object { -not $_.LastLogonTimestamp }
$TotalNeverLoggedIn = $NeverLoggedInUsers.Count

# Total enabled users
$TotalEnabled = $EnabledUsers.Count

#---------------------------------------------------------#
# ManagedService Account
$ManagedServiceAccount = Get-ADServiceAccount -Filter * | Where-Object {$_.objectClass -eq "msDS-ManagedServiceAccount"}
$TotalManagedService = ($ManagedServiceAccount | Measure-Object).Count

# GroupManagedService Account
$GroupManagedService = Get-ADServiceAccount -Filter * | Where-Object {$_.objectClass -eq "msDS-GroupManagedServiceAccount"} 
$TotalGroupManagedService = ($GroupManagedService | Measure-Object).Count

# Users with Password never expires that might be used as Service Account
$UserPasswordNotExpired = Get-ADUser -Filter {PasswordNeverExpires -eq $true}
$TotalUserPasswordNotExpired = $UserPasswordNotExpired.Count

# Users per OU
Get-ADOrganizationalUnit -Filter * | ForEach-Object { Get-ADUser -Filter * -SearchBase $_.DistinguishedName | Measure-Object | Select-Object Name, Count } |
Export-csv "c:\Temp\UserCount_Per_ADO.csv" -NoTypeInformation

#Get User with names starting with svc
$UserWithSpecificName = Get-ADUser -Filter 'Name -like "svc*"'
$TotalUserWithSpecificName = ($UserWithSpecificName | Measure-Object).Count

# Display summary
Write-Host "Total Enabled Users: $TotalEnabled"
Write-Host "Active Users (Last 6 Months): $TotalActive"
Write-Host "Inactive Users (No Login in 6+ Months): $TotalInactive"
Write-Host "Users with No Recorded Login: $TotalNeverLoggedIn"
Write-Host "Managed Service Account: $TotalManagedService"
Write-Host "Grouped Managed Service Account: $TotalGroupManagedService"
Write-Host "User with Password never Expires: $TotalUserPasswordNotExpired"
Write-Host "User with Specific Name starting with svc : $TotalUserWithSpecificName"
